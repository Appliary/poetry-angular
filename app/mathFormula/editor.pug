div.mathFormula(ng-controller='mathFormula/editor')
    h4 {{ 'inputs:' + $root.__module.name + ':title' | translate }}
    table
        thead: tr
            th(ng-if="!formulaInput", colspan="2") {{ 'varName:' + $root.__module.name + ':col' | translate }}
            th(ng-if="!formulaInput", colspan="3") {{ 'device:' + $root.__module.name + ':col' | translate }}
            th(ng-if="formulaInput") {{ 'varName:' + $root.__module.name + ':col' | translate }}
            th(ng-if="formulaInput") {{ 'device:' + $root.__module.name + ':col' | translate }}
            th(ng-if="formulaInput") {{ 'measurement:' + $root.__module.name + ':col' | translate }}
            th(ng-if="formulaInput") {{ 'timeOffset:' + $root.__module.name + ':col' | translate }}
            th(ng-if="formulaInput") {{ 'currentValue:' + $root.__module.name + ':col' | translate }}
            th &nbsp;
        tbody
            tr( ng-repeat=' (i,input) in item.inputs ')

                //- Name of the variable
                td(ng-if="formulaInput"): b {{ input.varName }}
                td(ng-if="!formulaInput", colspan="2"): b {{input.varName}}

                //- Device name / Tags
                td(ng-if="formulaInput") {{ input.kind.slice(0,1) }}&nbsp;
                    em(ng-if="input.kind == 'tags'")
                        | {{ input.id }}
                    em(ng-if="input.kind != 'tags'")
                        a(ng-href="/deviceManager/{{input.kind}}/{{input.id}}" target="_blank")
                            | {{ input.id }}
                td(ng-if="!formulaInput", colspan="3", style="text-align: center") {{ input.kind.slice(0,1) }}&nbsp;
                    em(ng-if="input.kind == 'tags'")
                        | {{ input.id }}
                    em(ng-if="input.kind != 'tags'")
                        a(ng-href="/deviceManager/{{input.kind}}/{{input.id}}" target="_blank")
                            | {{ input.id }}

                //- Value type
                td(ng-if="formulaInput") {{ input.type }}&nbsp;
                    em(ng-if="input.indice !== undefined") {{ input.indice }}

                //- Time dimension
                td(ng-if='input.time && formulaInput')
                    | {{ input.time }} {{ 'days:unit'|translate}}
                td.muted(ng-if='!input.time && formulaInput')
                    | {{ 'last:time:formula' | translate }}

                //- Example value
                td.muted( ng-if=" !inputValues[ input.varName ].forEach && formulaInput" )
                    | {{ inputValues[ input.varName ] }}
                td.muted( ng-if=" inputValues[ input.varName ].forEach && formulaInput", ng-click="showVals(inputValues[ input.varName ])" )
                    | [ {{ inputValues[ input.varName ][0] }},â€¦ ]

                //- Delete btn
                td: button.lightButton.pull-right(ng-click='inputs.remove(i)')
                    | &times;

            tr
                td( colspan="4" ) &nbsp;
                td( colspan="2" )
                    button.lightButton.pull-right(ng-click='inputs.add()')
                        | {{ 'addInput:button:mathformula' | translate }}

    br
    h4(ng-if="formulaInput") {{ 'formula:' + $root.__module.name + ':title' | translate }}
    div.formula(ng-class='{error: currentOutputErr}', ng-if="formulaInput")
        textarea( ng-model='item.formula' )
        input( readonly, ng-value='currentOutput' )
    div(ng-if="!formulaInput")
        label(for="timeout")
          | {{ 'timeout:mathformula:field' | translate }}
        input(ng-model="item.timeout", required, type="number")

br
span.saved( ng-if=' item.__saved ' )
    | {{ 'saved:' + $root.__module.name | translate }}
span.failed( ng-if=' item.__failed ' )
    | {{ 'failed:save:' + $root.__module.name | translate }}
button(ng-click='save()', ng-disabled='currentOutputErr').pull-right.lightButton
    | {{ 'save:' + $root.__module.name + ':button' | translate }}
